<!DOCTYPE html>
<html>
<head>
  <meta http-equiv='content-type' value='text/html;charset=utf8'>
  <meta name='generator' value='Ronn/v0.7.3 (http://github.com/rtomayko/ronn/tree/0.7.3)'>
  <title>shotgun(1) - reloading rack development server</title>
  <style type='text/css' media='all'>
  /* style: man */
  body#manpage {margin:0}
  .mp {max-width:100ex;padding:0 9ex 1ex 4ex}
  .mp p,.mp pre,.mp ul,.mp ol,.mp dl {margin:0 0 20px 0}
  .mp h2 {margin:10px 0 0 0}
  .mp > p,.mp > pre,.mp > ul,.mp > ol,.mp > dl {margin-left:8ex}
  .mp h3 {margin:0 0 0 4ex}
  .mp dt {margin:0;clear:left}
  .mp dt.flush {float:left;width:8ex}
  .mp dd {margin:0 0 0 9ex}
  .mp h1,.mp h2,.mp h3,.mp h4 {clear:left}
  .mp pre {margin-bottom:20px}
  .mp pre+h2,.mp pre+h3 {margin-top:22px}
  .mp h2+pre,.mp h3+pre {margin-top:5px}
  .mp img {display:block;margin:auto}
  .mp h1.man-title {display:none}
  .mp,.mp code,.mp pre,.mp tt,.mp kbd,.mp samp,.mp h3,.mp h4 {font-family:monospace;font-size:14px;line-height:1.42857142857143}
  .mp h2 {font-size:16px;line-height:1.25}
  .mp h1 {font-size:20px;line-height:2}
  .mp {text-align:justify;background:#fff}
  .mp,.mp code,.mp pre,.mp pre code,.mp tt,.mp kbd,.mp samp {color:#131211}
  .mp h1,.mp h2,.mp h3,.mp h4 {color:#030201}
  .mp u {text-decoration:underline}
  .mp code,.mp strong,.mp b {font-weight:bold;color:#131211}
  .mp em,.mp var {font-style:italic;color:#232221;text-decoration:none}
  .mp a,.mp a:link,.mp a:hover,.mp a code,.mp a pre,.mp a tt,.mp a kbd,.mp a samp {color:#0000ff}
  .mp b.man-ref {font-weight:normal;color:#434241}
  .mp pre {padding:0 4ex}
  .mp pre code {font-weight:normal;color:#434241}
  .mp h2+pre,h3+pre {padding-left:0}
  ol.man-decor,ol.man-decor li {margin:3px 0 10px 0;padding:0;float:left;width:33%;list-style-type:none;text-transform:uppercase;color:#999;letter-spacing:1px}
  ol.man-decor {width:100%}
  ol.man-decor li.tl {text-align:left}
  ol.man-decor li.tc {text-align:center;letter-spacing:4px}
  ol.man-decor li.tr {text-align:right;float:right}
  </style>
  <style type='text/css' media='all'>
  /* style: toc */
  .man-navigation {display:block !important;position:fixed;top:0;left:113ex;height:100%;width:100%;padding:48px 0 0 0;border-left:1px solid #dbdbdb;background:#eee}
  .man-navigation a,.man-navigation a:hover,.man-navigation a:link,.man-navigation a:visited {display:block;margin:0;padding:5px 2px 5px 30px;color:#999;text-decoration:none}
  .man-navigation a:hover {color:#111;text-decoration:underline}
  </style>
</head>
<!--
  The following styles are deprecated and will be removed at some point:
  div#man, div#man ol.man, div#man ol.head, div#man ol.man.

  The .man-page, .man-decor, .man-head, .man-foot, .man-title, and
  .man-navigation should be used instead.
-->
<body id='manpage'>
  <div class='mp' id='man'>

  <div class='man-navigation' style='display:none'>
    <a href="#NAME">NAME</a>
    <a href="#SYNOPSIS">SYNOPSIS</a>
    <a href="#DESCRIPTION">DESCRIPTION</a>
    <a href="#OPTIONS">OPTIONS</a>
    <a href="#PRELOADING">PRELOADING</a>
    <a href="#INSTALLING">INSTALLING</a>
    <a href="#CONTRIBUTING">CONTRIBUTING</a>
    <a href="#VERSION-HISTORY">VERSION HISTORY</a>
    <a href="#SEE-ALSO">SEE ALSO</a>
    </div>

  <ol class='man-decor man-head man head'>
    <li class='tl'>shotgun(1)</li>
    <li class='tc'></li>
    <li class='tr'>shotgun(1)</li>
  </ol>

  <h2 id="NAME">NAME</h2>
<p class="man-name">
  <code>shotgun</code> - <span class="man-whatis">reloading rack development server</span>
</p>

<h2 id="SYNOPSIS">SYNOPSIS</h2>

<p><code>shotgun</code> [<var>options</var>] [<var>rackup-file</var>]</p>

<h2 id="DESCRIPTION">DESCRIPTION</h2>

<p><strong>Shotgun</strong> is a simple process-per-request <a href="http://rack.rubyforge.org/doc/README.html">Rack</a> server designed for use in
development environments. Each time a request is received, <code>shotgun</code> forks,
loads the <var>rackup-file</var>, processes a single request and exits.  The result is
application-wide reloading of all configuration, source files, and templates
without the need for complex application-level reloading logic.</p>

<p>When no <var>rackup-file</var> is given, <code>shotgun</code> uses the <code>config.ru</code> file in the
current working directory.</p>

<h2 id="OPTIONS">OPTIONS</h2>

<p>Shotgun runs at <code>http://127.0.0.1:9393</code> by default. The following options
control server behavior:</p>

<dl>
<dt><code>-E</code>, <code>--env</code>=<var>environment</var></dt><dd><p>Sets the <code>RACK_ENV</code> environment variable to <var>environment</var> and selects
the default set of utility middleware. When <var>environment</var> is 'development',
shotgun inserts the <code>Rack::Lint</code> and <code>Rack::CommonLogger</code> middleware
components; when <var>environment</var> is 'production' or 'deployed',
<code>Rack::CommonLogger</code> is inserted; otherwise, no utility middleware are
inserted.</p></dd>
<dt><code>-P</code>, <code>--public</code>=<var>path</var></dt><dd><p>Serve requests for static files that exist under <var>path</var> from the shotgun
master process without forking a worker process. This option is
automatically enabled when a <code>./public</code> directory is detected, but can be
configured explicitly for non-conventional static file directory locations.</p>

<p>Setting this option appropriately can severely improve overall page load
times for applications with many static assets.</p></dd>
<dt><code>-s</code>, <code>--server</code>=<var>mongrel</var>|<var>webrick</var>|<var>thin</var>|<var>other</var></dt><dd><p>The Rack server handler implementation used to serve requests. Supported
values include: <code>mongrel</code>, <code>webrick</code>, and <code>thin</code>. By default, shotgun first
tries to use <code>mongrel</code> and falls back to <code>webrick</code> if mongrel is not
available.</p></dd>
<dt><code>-o</code>, <code>--host</code>=<var>addr</var></dt><dd><p>The hostname or address of the interface the HTTP server should bind to.
Default: <code>127.0.0.1</code>.</p></dd>
<dt><code>-p</code>, <code>--port</code>=<var>port</var></dt><dd><p>The port the HTTP server should bind to. Default: <code>9393</code>.</p></dd>
<dt><code>-O</code>, <code>--browse</code></dt><dd><p>Open browser at http://<var>host</var>:<var>port</var>/ immediately after the server
is started.</p></dd>
</dl>


<p>Ruby environment related options:</p>

<dl>
<dt><code>-r</code>, <code>--require</code> <var>library</var></dt><dd><p>Require <var>library</var> before loading the application and starting the server.
This can be used to load a portion of the application code in the master
process so it doesn't need to be loaded in the child. See <a href="#PRELOADING" title="PRELOADING" data-bare-link="true">PRELOADING</a>][]
for more information on this approach.</p></dd>
<dt><code>-e</code>, <code>--eval</code> <var>command</var></dt><dd><p>Evaluate arbitrary <var>command</var> within the shotgun master Ruby interpreter.
<var>command</var> is evaluated as program arguments are parsed. Multiple <code>-e</code>
arguments are allowed.</p></dd>
<dt><code>-d</code>, <code>--debug</code></dt><dd><p>Turns on debug mode. <code>$DEBUG</code> will be set <code>true</code>.</p></dd>
<dt><code>-w</code>, <code>--warn</code></dt><dd><p>Enable verbose mode without printing version message at the beginning. It
sets the <code>$VERBOSE</code> variable to true.</p></dd>
<dt><code>-I</code>, <code>--include</code> <var>path</var></dt><dd><p>Add <var>path</var> to the Ruby load path (<code>$LOAD_PATH</code>). May be used more than once.</p></dd>
</dl>


<p>Miscellaneous:</p>

<dl>
<dt><code>-h</code>, <code>--help</code></dt><dd><p>Show usage message and exit.</p></dd>
<dt><code>--version</code></dt><dd><p>Show the Rack version and exit.</p></dd>
</dl>


<h2 id="PRELOADING">PRELOADING</h2>

<p>It's possible to load support libraries and portions of the application in the
shotgun master process to reduce the amount of work that needs to be done for
each request in worker processes. There's two ways of accomplishing this: either
by specifying one or more <code>--require</code> (<code>-r</code>) arguments or through the use of a
<code>shotgun.rb</code> file.</p>

<p>During start up, shotgun looks for a <code>shotgun.rb</code> or <code>config/shotgun.rb</code> file.
If either file is found, it's loaded into the shotgun master process. Code at
the top-level of the <code>shotgun.rb</code> is run once on startup, so just require
whatever you want to preload. It's also possible to register callbacks to run
before each request in either the master or child worker process:</p>

<dl>
<dt><code>after_fork {</code> <var>stuff</var> <code>}</code></dt><dd><p>Run <var>stuff</var> in the shotgun child worker process immediately after forking.
Any files or socket connections opened in the master process should be
closed / re-established by an <code>after_fork</code> block.</p></dd>
<dt><code>before_fork {</code> <var>stuff</var> <code>}</code></dt><dd><p>Run <var>stuff</var> in the shotgun master process on each request before forking
the child worker process. This is typically less useful than <code>after_fork</code>,
but provided for completeness.</p></dd>
</dl>


<p>Example <code>config/shotgun.rb</code> file from the main github.com rails project:</p>

<pre><code># make sure the load path includes RAILS_ROOT
ENV['RAILS_ROOT'] ||= File.expand_path('../..', __FILE__)
$:.unshift ENV['RAILS_ROOT']

# bring in the base rails environment and some libraries
require 'config/environment'
require 'google-charts'
require 'aws-s3'

# disable Rails's built in class reloading
Rails.configuration.cache_classes = true

# reset database and redis connections in workers
after_fork do
  ActiveRecord::Base.establish_connection
  CHIMNEY.client = $redis
end
</code></pre>

<h2 id="INSTALLING">INSTALLING</h2>

<p>Shotgun is distributed as a gem package at rubygems.org:</p>

<p><a href="http://rubygems.org/gems/shotgun" data-bare-link="true">http://rubygems.org/gems/shotgun</a><br />
<code>gem install shotgun</code></p>

<p>The <code>rack</code> package is required. The <code>mongrel</code> package is recommended.</p>

<h2 id="CONTRIBUTING">CONTRIBUTING</h2>

<p>Fork and report issues at github.com:</p>

<p><a href="http://github.com/rtomayko/shotgun/" data-bare-link="true">http://github.com/rtomayko/shotgun/</a><br />
<code>git clone git://github.com/rtomayko/shotgun.git</code></p>

<h2 id="VERSION-HISTORY">VERSION HISTORY</h2>

<h3 id="Version-0-9-2011-February-24-">Version 0.9 (2011 February 24)</h3>

<ul>
<li><p><a href="http://github.com/rtomayko/shotgun/compare/0.8...0.9" data-bare-link="true">http://github.com/rtomayko/shotgun/compare/0.8...0.9</a></p></li>
<li><p>Various Ruby 1.9.2 fixes.</p></li>
<li><p>Handle application class names consisting of multiple words.</p></li>
</ul>


<h3 id="Version-0-8-2010-June-24-">Version 0.8 (2010 June 24)</h3>

<ul>
<li><p><a href="http://github.com/rtomayko/shotgun/compare/0.7...0.8" data-bare-link="true">http://github.com/rtomayko/shotgun/compare/0.7...0.8</a></p></li>
<li><p>Preloading support. The <code>shotgun.rb</code> or <code>config/shotgun.rb</code> file is
loaded at startup and may require libraries and register callbacks
for fork events. See the section on <a href="#PRELOADING" title="PRELOADING" data-bare-link="true">PRELOADING</a>.</p></li>
<li><p>Fix starting with the Thin handler (<code>shotgun -s thin</code>)</p></li>
<li><p>Actually include the <a href="shotgun.1.html" class="man-ref">shotgun<span class="s">(1)</span></a> roff manual.</p></li>
</ul>


<h3 id="Version-0-7-2010-June-22-">Version 0.7 (2010 June 22)</h3>

<ul>
<li><p><a href="http://github.com/rtomayko/shotgun/compare/0.6...0.7" data-bare-link="true">http://github.com/rtomayko/shotgun/compare/0.6...0.7</a></p></li>
<li><p>Static files now served from the shotgun master process, making
shotgun tolerable for apps with many/unbundled static assets.</p></li>
<li><p>Added <code>--public</code> (<code>-P</code>) for specifying a non-standard root / public
directory.</p></li>
<li><p>Response bodies are now streamed over the master &lt; worker pipe
instead of being marshalled. Improves performance with large response
bodies, and reduces shotgun master process RES usage.</p></li>
<li><p>GET /favicon.ico requests are served an empty response by the shotgun
master process. Prevents the need to fork a worker process.</p></li>
<li><p><code>INT</code>, <code>TERM</code>, <code>QUIT</code> now properly trigger server shutdown. The second
<code>INT</code>, <code>TERM</code>, <code>QUIT</code> causes the master process to exit hard.</p></li>
<li><p>Non <code>.ru</code> config files (e.g., sinatra app files) may now define command
line options in the same way as <code>.ru</code> files: by including a
<code>#\ -p 5555 ...</code> line.</p></li>
</ul>


<h3 id="Versions-0-7-2009-2010-">Versions &lt; 0.7 (2009-2010)</h3>

<ul>
<li><a href="http://github.com/rtomayko/shotgun/commits/0.6" data-bare-link="true">http://github.com/rtomayko/shotgun/commits/0.6</a></li>
</ul>


<h2 id="SEE-ALSO">SEE ALSO</h2>

<p><a href="http://man.cx/ruby" class="man-ref">ruby<span class="s">(1)</span></a></p>


  <ol class='man-decor man-foot man foot'>
    <li class='tl'>Shotgun 0.9</li>
    <li class='tc'>February 2011</li>
    <li class='tr'>shotgun(1)</li>
  </ol>

  </div>
</body>
</html>
